# Разбор единственного числа с плавающей точкой

Синтаксический разбор входного потока включает два этапа:
  1. построение синтаксического анализатора и
  1. применение анализатора к входному потоку.

Давайте начнем с простого примера: синтаксический разбор строки представляющей собой отдельное число с плавающей точкой.
В этом случае первый шаг будет тривиальным, так как модуль,  [`CharParsers`](http://www.quanttec.com/fparsec/reference/charparsers.html) уже включает анализатор числа с плавающей точкой:

```fsharp
val pfloat: Parser<float,'u>
```

Обобщенный тип `Parser<'Result,'UserState>` является типом всех синтаксических анализаторов в библиотеке FParsec. Если вы перейдете по следующей гиперссылке к справочнику,то вы увидите, что [`Parser`](http://www.quanttec.com/fparsec/reference/primitives.html#members.Parser) является [псевдоним](https://msdn.microsoft.com/ru-ru/library/dd233246.aspx) для типа-функции. Однако, сейчас нам не нужно вдаваться в детали типа `Parser`. Достаточно отметить, что первый аргумент типа представляет тип результата синтаксического анализа. Итак, в рассматриваемом случае тип функции [`pfloat`](http://www.quanttec.com/fparsec/reference/charparsers.html#members.pfloat) говорит нам, что, в случае успешного разбора функция вернет число с плавающей точкой типа `float`. Мы не будем использовать пользовательское состояние синтаксического анализатора (`UserState`) в этом учебнике, так что, пока, вы можете просто игнорировать второй аргумент.

Для того, чтобы применить синтаксический анализатор `pfloat` к строке, мы можем использовать функцию [`run`](http://www.quanttec.com/fparsec/reference/charparsers.html#members.run) из модуля `CharParsers`:

```fsharp
val run: Parser<'Result, unit> -> string -> ParserResult<'Result,unit>
```

Функция `run`, простейшая из [ряда](http://www.quanttec.com/fparsec/reference/charparsers.html#interface.runparser-functions) функций модуля `CharParsers`, используется для запуска синтаксического анализа входных данных. Другие функции позволяют вам, например, запускать синтаксические анализаторы по содержимому файла или потоку ввода-вывода (`System.IO.Stream`).

Функция `run` применяет синтаксический анализатор, переданный в качестве первого аргумента, к строке переданной в качестве второго аргумента и возвращает результат в виде `ParserResult`. Тип [`ParserResult`](http://www.quanttec.com/fparsec/reference/charparsers.html#members.ParserResult)  — это размеченное объединение с двумя вариантами : `Success` и `Failure`. В случае, если синтаксический анализатор успешно выполнен, `ParserResult` содержит результирующее значение, в противном случае он содержит сообщение об ошибке.

Для упрощения тестирования мы напишем маленькую вспомогательную функцию, которая выводит на печать значение результата или сообщение об ошибке:

```fsharp
let test p str =
    match run p str with
    | Success(result, _, _)   -> printfn "Success: %A" result
    | Failure(errorMsg, _, _) -> printfn "Failure: %s" errorMsg
```

Теперь мы можем протестировать `pfloat` выполнив

```fsharp
test pfloat "1.25"
```

что в результате даст:

```
Success: 1.25
```

Тестирование `pfloat` с числом, имеющим некорректную экспоненту

```fsharp
test pfloat "1.25E 3"
```

выводит следующее сообщение об ошибке:

```
Failure: Error in Ln: 1 Col: 6
1.25E 3
     ^
Expecting: decimal digit
```
